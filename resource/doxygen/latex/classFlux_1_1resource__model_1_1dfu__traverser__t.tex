\hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t}{}\doxysubsection{Flux\+::resource\+\_\+model\+::dfu\+\_\+traverser\+\_\+t Class Reference}
\label{classFlux_1_1resource__model_1_1dfu__traverser__t}\index{Flux::resource\_model::dfu\_traverser\_t@{Flux::resource\_model::dfu\_traverser\_t}}


{\ttfamily \#include $<$dfu.\+hpp$>$}



Inheritance diagram for Flux\+::resource\+\_\+model\+::dfu\+\_\+traverser\+\_\+t\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=190pt]{classFlux_1_1resource__model_1_1dfu__traverser__t__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Flux\+::resource\+\_\+model\+::dfu\+\_\+traverser\+\_\+t\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=318pt]{classFlux_1_1resource__model_1_1dfu__traverser__t__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_a5e3c7395ae1167145150e6fb11db33c6}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_a5e3c7395ae1167145150e6fb11db33c6}} 
{\bfseries dfu\+\_\+traverser\+\_\+t} (std\+::shared\+\_\+ptr$<$ f\+\_\+resource\+\_\+graph\+\_\+t $>$ g, std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{structFlux_1_1resource__model_1_1resource__graph__db__t}{resource\+\_\+graph\+\_\+db\+\_\+t}} $>$ db, std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__match__cb__t}{dfu\+\_\+match\+\_\+cb\+\_\+t}} $>$ m)
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_aa8d02658bccdfb550b3b450c0dc556ea}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_aa8d02658bccdfb550b3b450c0dc556ea}} 
{\bfseries dfu\+\_\+traverser\+\_\+t} (const \mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__traverser__t}{dfu\+\_\+traverser\+\_\+t}} \&o)
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_a82cd306cd71a3ed2960f9a08b671e72c}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_a82cd306cd71a3ed2960f9a08b671e72c}} 
{\bfseries dfu\+\_\+traverser\+\_\+t} (\mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__traverser__t}{dfu\+\_\+traverser\+\_\+t}} \&\&o)=default
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_a8baee0edd70d9421cdce8c60573ab2bf}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_a8baee0edd70d9421cdce8c60573ab2bf}} 
\mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__traverser__t}{dfu\+\_\+traverser\+\_\+t}} \& {\bfseries operator=} (const \mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__traverser__t}{dfu\+\_\+traverser\+\_\+t}} \&o)
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_a400857702b3d4c127e3287f9c19bd78b}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_a400857702b3d4c127e3287f9c19bd78b}} 
\mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__traverser__t}{dfu\+\_\+traverser\+\_\+t}} \& {\bfseries operator=} (\mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__traverser__t}{dfu\+\_\+traverser\+\_\+t}} \&\&o)=default
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_a89e4c053f0f5e1c9cf5efd951d085f8d}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_a89e4c053f0f5e1c9cf5efd951d085f8d}} 
const std\+::shared\+\_\+ptr$<$ const f\+\_\+resource\+\_\+graph\+\_\+t $>$ {\bfseries get\+\_\+graph} () const
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_af256e8fa402e71215655671a561dfe69}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_af256e8fa402e71215655671a561dfe69}} 
const std\+::shared\+\_\+ptr$<$ const \mbox{\hyperlink{structFlux_1_1resource__model_1_1resource__graph__db__t}{resource\+\_\+graph\+\_\+db\+\_\+t}} $>$ {\bfseries get\+\_\+graph\+\_\+db} () const
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_a6d6f9e4b50345078d3708ef4f6e02909}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_a6d6f9e4b50345078d3708ef4f6e02909}} 
const std\+::shared\+\_\+ptr$<$ const \mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__match__cb__t}{dfu\+\_\+match\+\_\+cb\+\_\+t}} $>$ {\bfseries get\+\_\+match\+\_\+cb} () const
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_ad8f08c7863d7a9b3456fdee2c20a8a9c}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_ad8f08c7863d7a9b3456fdee2c20a8a9c}} 
const std\+::string \& {\bfseries err\+\_\+message} () const
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_aecc3bb47d9997aeda3d7ced470be65f9}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_aecc3bb47d9997aeda3d7ced470be65f9}} 
const unsigned int {\bfseries get\+\_\+total\+\_\+preorder\+\_\+count} () const
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_a4f6806b0756f3d62366981776ce45478}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_a4f6806b0756f3d62366981776ce45478}} 
const unsigned int {\bfseries get\+\_\+total\+\_\+postorder\+\_\+count} () const
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_a27f675abfd1b2acf6dc98b0c5f2f6493}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_a27f675abfd1b2acf6dc98b0c5f2f6493}} 
void {\bfseries set\+\_\+graph} (std\+::shared\+\_\+ptr$<$ f\+\_\+resource\+\_\+graph\+\_\+t $>$ g)
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_a761a427d50bd6b77d8a4bb31fa374b07}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_a761a427d50bd6b77d8a4bb31fa374b07}} 
void {\bfseries set\+\_\+graph\+\_\+db} (std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{structFlux_1_1resource__model_1_1resource__graph__db__t}{resource\+\_\+graph\+\_\+db\+\_\+t}} $>$ db)
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_a36b6fd98f59b9a08a69afcf7370fc365}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_a36b6fd98f59b9a08a69afcf7370fc365}} 
void {\bfseries set\+\_\+match\+\_\+cb} (std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__match__cb__t}{dfu\+\_\+match\+\_\+cb\+\_\+t}} $>$ m)
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_a6d9cfad17fe292871d0c33b4061999ec}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_a6d9cfad17fe292871d0c33b4061999ec}} 
void {\bfseries clear\+\_\+err\+\_\+message} ()
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_a1baf0c834c3e334079268a002e87c846}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_a1baf0c834c3e334079268a002e87c846}} 
bool {\bfseries is\+\_\+initialized} () const
\item 
int \mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__traverser__t_ac50ded5b8aef81799cb61ab9d38111ea}{initialize}} ()
\item 
int \mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__traverser__t_af3c55645e5380df819980d815b8d18fe}{initialize}} (std\+::shared\+\_\+ptr$<$ f\+\_\+resource\+\_\+graph\+\_\+t $>$ g, std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{structFlux_1_1resource__model_1_1resource__graph__db__t}{resource\+\_\+graph\+\_\+db\+\_\+t}} $>$ db, std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__match__cb__t}{dfu\+\_\+match\+\_\+cb\+\_\+t}} $>$ m)
\item 
int \mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__traverser__t_adfcd9c1b83f6377fa849f671853833bf}{run}} (\mbox{\hyperlink{classFlux_1_1Jobspec_1_1Jobspec}{Jobspec\+::\+Jobspec}} \&jobspec, std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classFlux_1_1resource__model_1_1match__writers__t}{match\+\_\+writers\+\_\+t}} $>$ \&writers, match\+\_\+op\+\_\+t op, int64\+\_\+t id, int64\+\_\+t $\ast$at)
\item 
int \mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__traverser__t_a9dad4268009c8e0c3a3b4a8b701379f7}{run}} (const std\+::string \&str, std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classFlux_1_1resource__model_1_1match__writers__t}{match\+\_\+writers\+\_\+t}} $>$ \&writers, std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classFlux_1_1resource__model_1_1resource__reader__base__t}{resource\+\_\+reader\+\_\+base\+\_\+t}} $>$ \&reader, int64\+\_\+t id, int64\+\_\+t at, uint64\+\_\+t duration)
\item 
int \mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__traverser__t_a114a298047707fd8b4a63cc26e7decd4}{find}} (std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classFlux_1_1resource__model_1_1match__writers__t}{match\+\_\+writers\+\_\+t}} $>$ \&writers, const std\+::string \&criteria)
\item 
int \mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__traverser__t_a681918449339ce8024544ceeb2a6e322}{remove}} (int64\+\_\+t jobid)
\item 
int \mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__traverser__t_ae3a1781adbda5adb42b370ad528fc435}{mark}} (const std\+::string \&root\+\_\+path, resource\+\_\+pool\+\_\+t\+::status\+\_\+t status)
\item 
int \mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__traverser__t_a04ce7996b9fd008c8d9fb00049f1fffc}{mark}} (std\+::set$<$ int64\+\_\+t $>$ \&ranks, resource\+\_\+pool\+\_\+t\+::status\+\_\+t status)
\end{DoxyCompactItemize}
\doxysubsubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_a7062f45b19bdf418dc5f6081016c1ca4}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_a7062f45b19bdf418dc5f6081016c1ca4}} 
int {\bfseries is\+\_\+satisfiable} (\mbox{\hyperlink{classFlux_1_1Jobspec_1_1Jobspec}{Jobspec\+::\+Jobspec}} \&jobspec, \mbox{\hyperlink{structFlux_1_1resource__model_1_1detail_1_1jobmeta__t}{detail\+::jobmeta\+\_\+t}} \&meta, bool x, vtx\+\_\+t root, std\+::unordered\+\_\+map$<$ std\+::string, int64\+\_\+t $>$ \&dfv)
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_adb76d715c77435adf1a39eaa3a5d8e99}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_adb76d715c77435adf1a39eaa3a5d8e99}} 
int {\bfseries schedule} (\mbox{\hyperlink{classFlux_1_1Jobspec_1_1Jobspec}{Jobspec\+::\+Jobspec}} \&jobspec, \mbox{\hyperlink{structFlux_1_1resource__model_1_1detail_1_1jobmeta__t}{detail\+::jobmeta\+\_\+t}} \&meta, bool x, match\+\_\+op\+\_\+t op, vtx\+\_\+t root, std\+::unordered\+\_\+map$<$ std\+::string, int64\+\_\+t $>$ \&dfv)
\end{DoxyCompactItemize}
\doxysubsubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_a2e56a506ee6c15c8568431e8e15d0d2a}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_a2e56a506ee6c15c8568431e8e15d0d2a}} 
bool {\bfseries m\+\_\+initialized} = false
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_ac40ffb8efaff66f0bd5a86a7640fcc73}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_ac40ffb8efaff66f0bd5a86a7640fcc73}} 
unsigned int {\bfseries m\+\_\+total\+\_\+preorder} = 0
\item 
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_af2f19deadb2ea7e6fffa34d2bd7ab4dc}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_af2f19deadb2ea7e6fffa34d2bd7ab4dc}} 
unsigned int {\bfseries m\+\_\+total\+\_\+postorder} = 0
\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}


\doxysubsubsection{Detailed Description}
Depth-\/\+First-\/and-\/\+Up traverser. Perform depth-\/first visit on the dominant subsystem and upwalk on each and all of the auxiliary subsystems selected by the matcher callback object (\mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__match__cb__t}{dfu\+\_\+match\+\_\+cb\+\_\+t}}). Corresponding match callback methods are invoked at various well-\/defined graph visit events. 

\doxysubsubsection{Member Function Documentation}
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_a114a298047707fd8b4a63cc26e7decd4}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_a114a298047707fd8b4a63cc26e7decd4}} 
\index{Flux::resource\_model::dfu\_traverser\_t@{Flux::resource\_model::dfu\_traverser\_t}!find@{find}}
\index{find@{find}!Flux::resource\_model::dfu\_traverser\_t@{Flux::resource\_model::dfu\_traverser\_t}}
\doxyparagraph{\texorpdfstring{find()}{find()}}
{\footnotesize\ttfamily int dfu\+\_\+traverser\+\_\+t\+::find (\begin{DoxyParamCaption}\item[{std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classFlux_1_1resource__model_1_1match__writers__t}{match\+\_\+writers\+\_\+t}} $>$ \&}]{writers,  }\item[{const std\+::string \&}]{criteria }\end{DoxyParamCaption})}

Traverse the resource graph and emit those resources whose status is matched with the matching criteria.


\begin{DoxyParams}{Parameters}
{\em writers} & vertex/edge writers to emit the matched labels \\
\hline
{\em criteria} & matching criteria expression string. Each individual criterion is expressed as a key-\/value pair, representing a predicate p(x) where key is is p and value is x. Currently supported expressions are \char`\"{}status=\{up$\vert$down\}\char`\"{}, \char`\"{}sched-\/now=\{allocated$\vert$free\}\char`\"{}, \char`\"{}sched-\/future=\{reserved$\vert$free\}, or any combination                  of them separated with \char`\"{}and\char`\"{}, \char`\"{}or\char`\"{}, or a whitespace                  which is also interpreted as \char`\"{}and"{} logical operator of two expressions. Parentheses are supported to group expressions with a higher operator precedence. For example, in \char`\"{}status=up and                  (sched-\/now=allocated or sched-\/future=reserved)\char`\"{} The parenthesized expression is evaluated before taking the \char`\"{}and\char`\"{} operator with the the result of the first predicate. Other extra whitespaces around predicates are ignored. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success; -\/1 on error. 
\end{DoxyReturn}
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_ac50ded5b8aef81799cb61ab9d38111ea}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_ac50ded5b8aef81799cb61ab9d38111ea}} 
\index{Flux::resource\_model::dfu\_traverser\_t@{Flux::resource\_model::dfu\_traverser\_t}!initialize@{initialize}}
\index{initialize@{initialize}!Flux::resource\_model::dfu\_traverser\_t@{Flux::resource\_model::dfu\_traverser\_t}}
\doxyparagraph{\texorpdfstring{initialize()}{initialize()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily int dfu\+\_\+traverser\+\_\+t\+::initialize (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Prime the resource graph with subtree plans. Assume that resource graph, roots and match callback have already been registered. The subtree plans are instantiated on certain resource vertices and updated with the information on their subtree resources. For example, the subtree plan of a compute node resource vertex can be configured to track the number of available compute cores in aggregate at its subtree. \mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__match__cb__t}{dfu\+\_\+match\+\_\+cb\+\_\+t}} provides an interface to tell this initializer what subtree resources to track at higher-\/level resource vertices.

\begin{DoxyReturn}{Returns}
0 on success; -\/1 on error. EINVAL\+: graph, roots or match callback not set. ENOTSUP\+: roots does not contain a subsystem the match callback object need to use. 
\end{DoxyReturn}
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_af3c55645e5380df819980d815b8d18fe}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_af3c55645e5380df819980d815b8d18fe}} 
\index{Flux::resource\_model::dfu\_traverser\_t@{Flux::resource\_model::dfu\_traverser\_t}!initialize@{initialize}}
\index{initialize@{initialize}!Flux::resource\_model::dfu\_traverser\_t@{Flux::resource\_model::dfu\_traverser\_t}}
\doxyparagraph{\texorpdfstring{initialize()}{initialize()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily int dfu\+\_\+traverser\+\_\+t\+::initialize (\begin{DoxyParamCaption}\item[{std\+::shared\+\_\+ptr$<$ f\+\_\+resource\+\_\+graph\+\_\+t $>$}]{g,  }\item[{std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{structFlux_1_1resource__model_1_1resource__graph__db__t}{resource\+\_\+graph\+\_\+db\+\_\+t}} $>$}]{db,  }\item[{std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__match__cb__t}{dfu\+\_\+match\+\_\+cb\+\_\+t}} $>$}]{m }\end{DoxyParamCaption})}

Prime the resource graph with subtree plans. Assume that resource graph, roots and match callback have already been registered. The subtree plans are instantiated on certain resource vertices and updated with the information on their subtree resources. For example, the subtree plan of a compute node resource vertex can be configured to track the number of available compute cores in aggregate at its subtree. \mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__match__cb__t}{dfu\+\_\+match\+\_\+cb\+\_\+t}} provides an interface to tell this initializer what subtree resources to track at higher-\/level resource vertices.


\begin{DoxyParams}{Parameters}
{\em g} & resource graph of f\+\_\+resource\+\_\+graph\+\_\+t type. \\
\hline
{\em roots} & map of root vertices, each is a root of a subsystem. \\
\hline
{\em m} & match callback object of \mbox{\hyperlink{classFlux_1_1resource__model_1_1dfu__match__cb__t}{dfu\+\_\+match\+\_\+cb\+\_\+t}} type. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success; -\/1 on error. EINVAL\+: graph, roots or match callback not set. ENOTSUP\+: roots does not contain a subsystem the match callback uses. 
\end{DoxyReturn}
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_ae3a1781adbda5adb42b370ad528fc435}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_ae3a1781adbda5adb42b370ad528fc435}} 
\index{Flux::resource\_model::dfu\_traverser\_t@{Flux::resource\_model::dfu\_traverser\_t}!mark@{mark}}
\index{mark@{mark}!Flux::resource\_model::dfu\_traverser\_t@{Flux::resource\_model::dfu\_traverser\_t}}
\doxyparagraph{\texorpdfstring{mark()}{mark()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily int dfu\+\_\+traverser\+\_\+t\+::mark (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{root\+\_\+path,  }\item[{resource\+\_\+pool\+\_\+t\+::status\+\_\+t}]{status }\end{DoxyParamCaption})}

Mark the resource status up$\vert$down$\vert$etc starting at subtree\+\_\+root.


\begin{DoxyParams}{Parameters}
{\em root\+\_\+path} & path to the root of the subtree to update. \\
\hline
{\em status} & new status value \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success; -\/1 on error. EINVAL\+: roots or by\+\_\+path not found. 
\end{DoxyReturn}
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_a04ce7996b9fd008c8d9fb00049f1fffc}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_a04ce7996b9fd008c8d9fb00049f1fffc}} 
\index{Flux::resource\_model::dfu\_traverser\_t@{Flux::resource\_model::dfu\_traverser\_t}!mark@{mark}}
\index{mark@{mark}!Flux::resource\_model::dfu\_traverser\_t@{Flux::resource\_model::dfu\_traverser\_t}}
\doxyparagraph{\texorpdfstring{mark()}{mark()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily int dfu\+\_\+traverser\+\_\+t\+::mark (\begin{DoxyParamCaption}\item[{std\+::set$<$ int64\+\_\+t $>$ \&}]{ranks,  }\item[{resource\+\_\+pool\+\_\+t\+::status\+\_\+t}]{status }\end{DoxyParamCaption})}

Mark the resource status up$\vert$down$\vert$etc for subgraph represented by ranks.


\begin{DoxyParams}{Parameters}
{\em ranks} & set of ranks representing the subgraph to update. \\
\hline
{\em status} & new status value \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success; -\/1 on error. EINVAL\+: roots or by\+\_\+path not found. 
\end{DoxyReturn}
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_a681918449339ce8024544ceeb2a6e322}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_a681918449339ce8024544ceeb2a6e322}} 
\index{Flux::resource\_model::dfu\_traverser\_t@{Flux::resource\_model::dfu\_traverser\_t}!remove@{remove}}
\index{remove@{remove}!Flux::resource\_model::dfu\_traverser\_t@{Flux::resource\_model::dfu\_traverser\_t}}
\doxyparagraph{\texorpdfstring{remove()}{remove()}}
{\footnotesize\ttfamily int dfu\+\_\+traverser\+\_\+t\+::remove (\begin{DoxyParamCaption}\item[{int64\+\_\+t}]{jobid }\end{DoxyParamCaption})}

Remove the allocation/reservation referred to by jobid and update the resource state.


\begin{DoxyParams}{Parameters}
{\em jobid} & job id. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success; -\/1 on error. EINVAL\+: graph, roots or match callback not set. 
\end{DoxyReturn}
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_a9dad4268009c8e0c3a3b4a8b701379f7}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_a9dad4268009c8e0c3a3b4a8b701379f7}} 
\index{Flux::resource\_model::dfu\_traverser\_t@{Flux::resource\_model::dfu\_traverser\_t}!run@{run}}
\index{run@{run}!Flux::resource\_model::dfu\_traverser\_t@{Flux::resource\_model::dfu\_traverser\_t}}
\doxyparagraph{\texorpdfstring{run()}{run()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily int dfu\+\_\+traverser\+\_\+t\+::run (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{str,  }\item[{std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classFlux_1_1resource__model_1_1match__writers__t}{match\+\_\+writers\+\_\+t}} $>$ \&}]{writers,  }\item[{std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classFlux_1_1resource__model_1_1resource__reader__base__t}{resource\+\_\+reader\+\_\+base\+\_\+t}} $>$ \&}]{reader,  }\item[{int64\+\_\+t}]{id,  }\item[{int64\+\_\+t}]{at,  }\item[{uint64\+\_\+t}]{duration }\end{DoxyParamCaption})}

Read str which is a serialized allocation data (e.\+g., written in JGF) with rd, and traverse the resource graph to update it with this data.


\begin{DoxyParams}{Parameters}
{\em str} & allocation string such as written in JGF. \\
\hline
{\em writers} & vertex/edge writers to emit the matched labels \\
\hline
{\em reader} & reader object that deserialize str to update the graph \\
\hline
{\em id} & job ID to use for the schedule operation. \\
\hline
{\em at} & the starting time of this job. \\
\hline
{\em duration} & the duration of this job \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success; -\/1 on error. TODO\+: Fill in errnos 
\end{DoxyReturn}
\mbox{\Hypertarget{classFlux_1_1resource__model_1_1dfu__traverser__t_adfcd9c1b83f6377fa849f671853833bf}\label{classFlux_1_1resource__model_1_1dfu__traverser__t_adfcd9c1b83f6377fa849f671853833bf}} 
\index{Flux::resource\_model::dfu\_traverser\_t@{Flux::resource\_model::dfu\_traverser\_t}!run@{run}}
\index{run@{run}!Flux::resource\_model::dfu\_traverser\_t@{Flux::resource\_model::dfu\_traverser\_t}}
\doxyparagraph{\texorpdfstring{run()}{run()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily int dfu\+\_\+traverser\+\_\+t\+::run (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classFlux_1_1Jobspec_1_1Jobspec}{Jobspec\+::\+Jobspec}} \&}]{jobspec,  }\item[{std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classFlux_1_1resource__model_1_1match__writers__t}{match\+\_\+writers\+\_\+t}} $>$ \&}]{writers,  }\item[{match\+\_\+op\+\_\+t}]{op,  }\item[{int64\+\_\+t}]{id,  }\item[{int64\+\_\+t $\ast$}]{at }\end{DoxyParamCaption})}

Begin a graph traversal for the jobspec and allocate, reserve or check its satisfiability on the resources in the resource graph. Best-\/matching resources are selected in accordance with the scoring done by the match callback methods. Initialization must have successfully finished before this method is called.


\begin{DoxyParams}{Parameters}
{\em jobspec} & Jobspec object. \\
\hline
{\em writers} & vertex/edge writers to emit the matched labels \\
\hline
{\em op} & schedule operation\+: allocate, allocate\+\_\+with\+\_\+satisfiability, allocate\+\_\+orelse\+\_\+reserve or satisfiability. \\
\hline
{\em id} & job ID to use for the schedule operation. \\
\hline
{\em at\mbox{[}out\mbox{]}} & when the job is scheduled if reserved. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success; -\/1 on error. EINVAL\+: graph, roots or match callback not set. ENOTSUP\+: roots does not contain a subsystem the match callback uses. EBUSY\+: cannot match because resources/devices are currently in use. ENODEV\+: unsatifiable jobspec because no resources/devices can satisfy the request. 
\end{DoxyReturn}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
dfu.\+hpp\item 
dfu.\+cpp\end{DoxyCompactItemize}
